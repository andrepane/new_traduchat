/* ==========================================================================
   Variables CSS Globales
   ========================================================================== */
   
/* =============================================================
   Tema visual: BANDERAS
   ============================================================= */

   .theme-set-banderas.theme-es {
    --color-primary: #c62828;
    --color-primary-dark: #8e0000;
    --color-primary-light: #f9a825;
    --color-bg: #fffdf5;
    --color-bg-alt: #ffffffcc;
    --color-border: #f4d9b0;
    --color-user-left: #fff2e0;
    --color-user-right: #fde1d9;
    --color-system: #8e8e8e;
    --color-system-bg: #faf2e3cc;
    --color-unread: #fff6d1;
    --color-text: #4a3b00;
  }
  
  .theme-set-banderas.theme-en {
    --color-primary: #274472;
    --color-primary-dark: #1b314f;
    --color-primary-light: #d94f4f;
    --color-bg: #f3f5fa;
    --color-bg-alt: #ffffffcc;
    --color-border: #ccd9e7;
    --color-user-left: #e6edf7;
    --color-user-right: #d4dfea;
    --color-system: #a3a9b1;
    --color-system-bg: #eef3facc;
    --color-unread: #ffecec;
     --color-text: #1a2d48;
  }
  
  .theme-set-banderas.theme-it {
    --color-primary: #3fa66b;
    --color-primary-dark: #2e7d4f;
    --color-primary-light: #d87272;
    --color-bg: #f6fcf9;
    --color-bg-alt: #ffffffcc;
    --color-border: #d6eadd;
    --color-user-left: #e8f6ef;
    --color-user-right: #ffe9e9;
    --color-system: #9ea9a2;
    --color-system-bg: #f0f8f2cc;
    --color-unread: #ffecec;
     --color-text: #1f4a33;
  }

  
  /* =============================================================
     Tema visual: ELEGANTE (pastel moderno)
     ============================================================= */
  
  .theme-set-elegante.theme-es {
    --color-primary: #a68dce;
    --color-primary-dark: #7b6fa6;
    --color-primary-light: #d8c9f2;
    --color-bg: #f9f7fc;
    --color-bg-alt: #ffffffcc;
    --color-border: #dcd1ef;
    --color-user-left: #ede5fa;
    --color-user-right: #dfcef7;
    --color-system: #9c9cae;
    --color-system-bg: #f2eefacc;
    --color-unread: #ede5fa;
     --color-text: #443c5c;
  }

  
  .theme-set-elegante.theme-en {
    --color-primary: #5c88c4;
    --color-primary-dark: #3f6da8;
    --color-primary-light: #a6c4e6;
    --color-bg: #f4f8fb;
    --color-bg-alt: #ffffffcc;
    --color-border: #d2e3f0;
    --color-user-left: #e6eef8;
    --color-user-right: #d0e3f7;
    --color-system: #9aa7b5;
    --color-system-bg: #eef3facc;
    --color-unread: #e6eef8;
     --color-text: #2c4564;
  }

  
  .theme-set-elegante.theme-it {
    --color-primary: #d77c7c;
    --color-primary-dark: #b55b5b;
    --color-primary-light: #efb3b3;
    --color-bg: #fff6f6;
    --color-bg-alt: #ffffffcc;
    --color-border: #f3d3d3;
    --color-user-left: #ffeaea;
    --color-user-right: #f5cfcf;
    --color-system: #a89e9e;
    --color-system-bg: #fff1f1cc;
    --color-unread: #ffeaea;
     --color-text: #6c3f3f;
  }

  
  /* =============================================================
     Tema visual: CREATIVO (colorido y vibrante)
     ============================================================= */
  
  .theme-set-creativo.theme-es {
    --color-primary: #ff8c42;
    --color-primary-dark: #d67636;
    --color-primary-light: #ffd1a9;
    --color-bg: #fff8f0;
    --color-bg-alt: #ffffffcc;
    --color-border: #ffdcbf;
    --color-user-left: #fff0e0;
    --color-user-right: #ffddb8;
    --color-system: #a08877;
    --color-system-bg: #fff1e7cc;
    --color-unread: #fff0e0;
     --color-text: #5e3b19;
  }

  
  .theme-set-creativo.theme-en {
    --color-primary: #00bcd4;
    --color-primary-dark: #0097a7;
    --color-primary-light: #a7e6ec;
    --color-bg: #f0fcfd;
    --color-bg-alt: #ffffffcc;
    --color-border: #c2eef3;
    --color-user-left: #e0f7fa;
    --color-user-right: #b2ebf2;
    --color-system: #779fa1;
    --color-system-bg: #e8f8facc;
    --color-unread: #e0f7fa;
     --color-text: #02575e;
  }

  
  .theme-set-creativo.theme-it {
    --color-primary: #ce4b99;
    --color-primary-dark: #a2387b;
    --color-primary-light: #f5b0d8;
    --color-bg: #fff4fa;
    --color-bg-alt: #ffffffcc;
    --color-border: #f8cce5;
    --color-user-left: #ffe5f4;
    --color-user-right: #fdd5ed;
    --color-system: #a98ca2;
    --color-system-bg: #fff0f7cc;
    --color-unread: #ffe5f4;
     --color-text: #6a3262;
  }

  
  /* =============================================================
     Tema visual: ELEGANTE 2 (pastel moderno)
     ============================================================= */
  
  
  .theme-set-elegante2.theme-es {
    --color-primary: #7ca57c;         /* verde té matcha */
    --color-primary-dark: #5b8c5b;
    --color-primary-light: #cfe4cf;
    --color-bg: #f8fbf8;
    --color-bg-alt: #ffffffcc;
    --color-border: #dbe8db;
    --color-user-left: #eef6ee;
    --color-user-right: #d0e8d0;
    --color-system: #8e9e8e;
    --color-system-bg: #f0f6f0cc;
    --color-unread: #eef6ee;
     --color-text: #3c553c;
  }

  
  .theme-set-elegante2.theme-en {
    --color-primary: #5f758e;         /* azul grisáceo suave */
    --color-primary-dark: #4c6073;
    --color-primary-light: #a8bacd;
    --color-bg: #f4f6f8;
    --color-bg-alt: #ffffffcc;
    --color-border: #d8dfe7;
    --color-user-left: #e7edf3;
    --color-user-right: #cdd9e4;
    --color-system: #8a9aa7;
    --color-system-bg: #eef3f7cc;
    --color-unread: #e7edf3;
     --color-text: #2e3f51;
  }

  
  .theme-set-elegante2.theme-it {
    --color-primary: #c5a27e;         /* beige tierra elegante */
    --color-primary-dark: #a28263;
    --color-primary-light: #e3c9a9;
    --color-bg: #faf8f5;
    --color-bg-alt: #ffffffcc;
    --color-border: #e4dcd2;
    --color-user-left: #f9f4ed;
    --color-user-right: #f1e1ce;
    --color-system: #a89f96;
    --color-system-bg: #f7f1eacc;
    --color-unread: #f9f4ed;
     --color-text: #5c4433;
  }

  
  
  
  
  :root {
      /* Colores por defecto (tema español) */
      --color-primary: #4caf50;
      --color-primary-dark: #006d34;
      --color-primary-light: #1ee98e;
      --color-bg: #f6faf7;
      --color-bg-alt: #ffffffcc;
      --color-border: #d1e7dd;
      --color-user-left: #e6fff4;
      --color-user-right: #b9f5d8;
      --color-system: #98a6a9;
      --color-system-bg: #f0f8f2cc;
      --color-unread: #fff6d1;

      /* Colores de texto y estados */
      --color-text: #232f2b;
      --color-text-light: #fff;
      --color-danger: #d32f2f;
      
      /* Dimensiones y espaciado */
      --radius: 17px;
      --radius-bubble: 20px;
      --header-height: 60px;
      --footer-height: 60px;
      --chat-max-width: 1200px;
      --message-input-height: 60px;
      
      /* Efectos y transiciones */
      --shadow: 0 8px 32px 0 rgba(60, 100, 60, 0.13);
      --shadow-glass: 0 4px 24px 0 rgba(0, 180, 81, 0.08);
      --transition: all 0.25s ease;
      
      /* Safe Areas para iOS */
      --safe-area-top: env(safe-area-inset-top, 0px);
      --safe-area-bottom: env(safe-area-inset-bottom, 0px);
      
      /* Tipografía */
      --font-main: "Poppins", "Segoe UI", system-ui, sans-serif;
  }
  
  /* ==========================================================================
     Reset y Estilos Base
     ========================================================================== */
  * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
      -webkit-tap-highlight-color: transparent;
      -webkit-touch-callout: none;
  }
  
  html, body {
      height: 100%;
      width: 100%;
      overflow: hidden;
      position: fixed;
      top: 0;
      left: 0;
  }
  
  body {
      font-family: var(--font-main);
      background: var(--color-bg);
      color: var(--color-text);
  }
  
  /* ==========================================================================
     Pantallas y Estados
     ========================================================================== */
  .screen {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      display: none;
      opacity: 0;
      visibility: hidden;
      transition: opacity 0.3s ease;
  }
  
  .screen.active {
      display: flex;
      opacity: 1;
      visibility: visible;
  }
  
  /* Pantalla de Autenticación */
  #authScreen {
      flex-direction: column;
      justify-content: center;
      align-items: center;
      padding: calc(1rem + var(--safe-area-top)) 1rem calc(1rem + var(--safe-area-bottom));
      background: var(--color-bg);
      min-height: 100vh;
  }
  
  .password-wrapper {
      position: relative;
      width: 100%;
  }
  
  #passwordInput {
      width: 100%;
      padding-right: 40px; /* espacio para el icono del ojo */
      box-sizing: border-box;
  }
  
  #togglePassword {
      position: absolute;
      right: 10px;
      top: 50%;
      transform: translateY(-50%);
      background: none;
      border: none;
      cursor: pointer;
      font-size: 18px;
  }
  
  
  /* Pantalla Principal */
  #mainScreen {
      display: none;
      height: 100%;
      width: 100%;
      position: relative;
      overflow: hidden;
  }
  
  #mainScreen.active {
      display: flex;
  }
  
  /* ==========================================================================
     Sidebar y Lista de Chats
     ========================================================================== */
  .sidebar {
      height: 100%;
      width: 350px;
      background: #fff;
      display: flex;
      flex-direction: column;
      position: relative;
      border-right: 1px solid var(--color-border);
      transition: transform 0.3s ease;
  }
  
  .sidebar.hidden {
      transform: translateX(-100%);
  }
  
  /* Chat Container */
  .chat-container {
      flex: 1;
      display: flex;
      flex-direction: column;
      background: var(--color-bg-alt);
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
      position: relative;
      overflow: hidden;
  }
  
  .chat-container.hidden {
      display: none;
  }
  
  /* ==========================================================================
     Loading Screen
     ========================================================================== */
  .loading-screen {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(255, 255, 255, 0.95);
      display: none;
      justify-content: center;
      align-items: center;
      z-index: 2000;
      backdrop-filter: blur(5px);
      -webkit-backdrop-filter: blur(5px);
  }
  
  /* ==========================================================================
     Responsive Design
     ========================================================================== */
  @media (max-width: 768px) {
      .sidebar {
          position: absolute;
          width: 100%;
          z-index: 100;
      }
  
      .chat-container {
          width: 100%;
      }
  
      .sidebar.hidden {
          display: none;
      }
  
      .chat-container.hidden {
          display: none;
      }
  
      #backToChats {
          display: none;
      }
  
      .chat-container:not(.hidden) ~ #backToChats {
          display: flex;
      }
  
      .user-header {
          padding-top: calc(12px + var(--safe-area-top));
      }
  
      .message-input {
          padding-bottom: calc(10px + var(--safe-area-bottom));
      }
  }
  
  /* ==========================================================================
     Ajustes iOS
     ========================================================================== */
  @supports (-webkit-touch-callout: none) {
      .keyboard-open #mainScreen {
          height: calc(100% - var(--keyboard-height));
      }
  
      .keyboard-open .messages-list {
          height: calc(100% - var(--header-height) - var(--message-input-height) - var(--keyboard-height));
      }
  
      .keyboard-open .message-input {
          position: absolute;
          bottom: var(--keyboard-height);
          left: 0;
          right: 0;
      }
  }
  
  /* ==========================================================================
     Layout Principal
     ========================================================================== */
  #mainScreen {
      display: flex;
      height: 100dvh;
      width: 100dvw;
      position: relative;
      overflow: hidden;
  }
  
  /* Sidebar */
  .user-header,
  .chat-header {
      height: var(--header-height);
      padding: 12px 15px;
      background-color: #fff;
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 10px;
      position: sticky;
      top: 0;
      z-index: 10;
      border-bottom: 1px solid var(--color-border);
  }
  
  .chat-header {
      background-color: var(--color-bg-alt);
  }
  
  .user-info {
      display: flex;
      align-items: center;
      gap: 10px;
      min-width: 0;
      flex: 1;
      position: relative;
  }
  
  #userInfo {
      font-weight: 600;
      color: var(--color-primary-dark);
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      flex: 1;
      min-width: 0;
  }

  /* Información del chat grupal */
  .group-info {
      display: flex;
      flex-direction: column;
      flex: 1;
      min-width: 0;
      overflow: hidden;
      cursor: pointer;
  }

  .group-name {
      font-weight: 700;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
  }

  .group-participants {
      font-size: 0.85rem;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      color: #333;
  }

  
  
  /* ==========================================================================
     Lista de Chats
     ========================================================================== */
  .chat-list {
      flex: 1;
      overflow-y: auto;
      background-color: #fff;
      -webkit-overflow-scrolling: touch;
      padding: 10px;
      padding-bottom: calc(120px + env(safe-area-inset-bottom, 0px));
      height: calc(100vh - var(--header-height) - env(safe-area-inset-bottom, 0px));
      position: relative;
      z-index: 1;
      scrollbar-width: thin;
      scrollbar-color: var(--color-primary) transparent;
  }
  
  .chat-item {
      display: flex;
      align-items: center;
      background-color: var(--color-bg);
      padding: 15px;
      border-radius: var(--radius);
      border-left: 3px solid var(--color-primary-dark);
      margin-bottom: 8px;
      transition: var(--transition);
      cursor: pointer;
      box-shadow: 0 2px 6px rgba(0,0,0,0.04);
      position: relative;
      padding-right: 40px;
  }
  
  .chat-item:hover {
      background-color: #f0f2f5;
      transform: translateY(-1px);
  }
  
  .chat-item.active {
      background-color: var(--color-user-left);
      border-left: 3px solid var(--color-primary);
  }

.chat-item.unread {
    background-color: var(--color-unread);
    border-left: 4px solid var(--color-primary-dark);
    font-weight: bold;
}

  
  .chat-info {
      flex: 1;
      min-width: 0;
      margin-right: 8px;
  }
  
  .delete-chat-btn {
      position: absolute;
      right: 12px;
      top: 50%;
      transform: translateY(-50%);
      opacity: 0;
      transition: all 0.2s ease;
      background: transparent;
      border: none;
      color: #99a4a9;
      padding: 6px;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      border-radius: 4px;
  }
  
  .delete-chat-btn i {
      font-size: 0.9rem;
  }
  
  .chat-item:hover .delete-chat-btn {
      opacity: 0.8;
  }
  
  .delete-chat-btn:hover {
      color: var(--color-danger);
      opacity: 1;
  }
  
  .chat-item.deleting {
      animation: slideOut 0.2s ease forwards;
  }
  
  @keyframes slideOut {
      to {
          transform: translateX(-100%);
          opacity: 0;
      }
  }
  
  /* ==========================================================================
     Contenedor de Chat y Mensajes
     ========================================================================== */
  .messages-list {
      flex: 1;
      overflow-y: auto;
      padding: 20px;
      -webkit-overflow-scrolling: touch;
      scroll-behavior: smooth;
      background: var(--color-bg-alt);
      display: flex;
      flex-direction: column;
  }
  
  /* Mensajes */
  .message {
      display: flex;
      flex-direction: column;
      max-width: 76%;
      margin-bottom: 8px;
      position: relative;
  }
  
  .message.sent {
      align-self: flex-end;
      margin-left: auto;
  }
  
  .message.received {
      align-self: flex-start;
      margin-right: auto;
  }
  
  .message-content {
      padding: 12px 16px;
      border-radius: var(--radius-bubble);
      word-break: break-word;
      font-size: 1rem;
      line-height: 1.4;
      box-shadow: var(--shadow-glass);
      transition: var(--transition);
      animation: messageAppear 0.3s ease;
  }
  
  .message.sent .message-content {
      background: linear-gradient(120deg, var(--color-user-right) 90%, var(--color-user-left) 100%);
      color: var(--color-primary-dark);
      border-bottom-right-radius: 6px;
  }
  
  .message.received .message-content {
      background: linear-gradient(120deg, var(--color-user-left) 60%, var(--color-bg) 100%);
      color: var(--color-text);
      border-bottom-left-radius: 6px;
  }
  
  .message-time {
      font-size: 0.65em;
      color: rgba(134, 150, 160, 0.9);
      margin-top: 4px;
      align-self: flex-end;
  }
  
  .message.sent .message-time {
      margin-right: 4px;
  }
  
  .message.received .message-time {
      margin-left: 4px;
  }
  
  /* Sistema de Mensajes Agrupados */
  .message[data-same-sender="true"] {
      margin-top: -4px;
  }
  
  .message[data-same-sender="true"] .message-sender {
      display: none;
  }
  
  /* Input de Mensajes */
  .message-input {
      padding: 10px 15px;
      background: #fff;
      border-top: 1px solid var(--color-border);
      display: flex;
      align-items: center;
      gap: 10px;
      position: relative;
      min-height: var(--message-input-height);
  }
  
  .message-input input {
      flex: 1;
      padding: 12px 16px;
      border-radius: 20px;
      border: 1px solid var(--color-border);
      font-size: 16px;
      background: var(--color-bg);
      transition: var(--transition);
  }
  
  .message-input input:focus {
      border-color: var(--color-primary);
      outline: none;
      background: #fff;
  }
  
  /* Botones de Acción */
  .icon-button {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      border: none;
      background: var(--color-primary);
      color: #fff;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: var(--transition);
  }
  
  .icon-button:hover {
      background: var(--color-primary-dark);
      transform: scale(1.05);
  }
  
  /* ==========================================================================
     Animaciones
     ========================================================================== */
  @keyframes messageAppear {
      from {
          opacity: 0;
          transform: translateY(10px);
      }
      to {
          opacity: 1;
          transform: translateY(0);
      }
  }
  
  /* ==========================================================================
     Media Queries - Mobile First
     ========================================================================== */
  @media (max-width: 768px) {
      .sidebar {
          position: fixed;
          width: 100%;
          height: 100%;
          z-index: 1000;
          transform: translateX(-100%);
          transition: transform 0.3s ease;
      }
  
      .sidebar.hidden {
          transform: translateX(-100%);
      }
  
      .sidebar:not(.hidden) {
          transform: translateX(0);
      }
  
      .chat-container {
          position: fixed;
          top: 0;
          left: 0;
          width: 100%;
          height: 100%;
          z-index: 900;
          display: none;
      }
  
      .chat-container:not(.hidden) {
          display: flex;
      }
  
      .back-button {
          display: flex !important;
          align-items: center;
          justify-content: center;
          width: 40px;
          height: 40px;
          border: none;
          background: transparent;
          color: var(--color-primary);
          cursor: pointer;
          margin-right: 10px;
      }
  
      .chat-header {
          padding-top: max(10px, var(--safe-area-top));
      }
  
      .message-input {
          padding-bottom: max(10px, var(--safe-area-bottom));
      }
  
      .messages-list {
          height: calc(100% - var(--header-height) - var(--message-input-height));
          padding-bottom: max(20px, var(--safe-area-bottom));
      }
  }
  
  /* ==========================================================================
     Ajustes iOS
     ========================================================================== */
  @supports (-webkit-touch-callout: none) {
      .keyboard-open .chat-container {
          height: calc(100% - var(--keyboard-height));
      }
  
      .keyboard-open .messages-list {
          height: calc(100% - var(--header-height) - var(--message-input-height) - var(--keyboard-height));
      }
  
      .keyboard-open .message-input {
          position: fixed;
          bottom: var(--keyboard-height);
          left: 0;
          right: 0;
          background: #fff;
      }
  
      .message-input {
          padding-bottom: max(10px, var(--safe-area-bottom));
      }
  
      .messages-list {
          padding-bottom: calc(var(--message-input-height) + env(safe-area-inset-bottom));
      }
  
      /* Prevenir zoom en inputs */
      input[type="text"],
      input[type="email"],
      input[type="password"] {
          font-size: 16px;
      }
  
      /* Ajustes para notch */
      @media screen and (device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3),
             screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 2),
             screen and (device-width: 390px) and (device-height: 844px) and (-webkit-device-pixel-ratio: 3),
             screen and (device-width: 428px) and (device-height: 926px) and (-webkit-device-pixel-ratio: 3) {
          :root {
              --safe-area-top: env(safe-area-inset-top, 44px);
              --safe-area-bottom: env(safe-area-inset-bottom, 34px);
          }
      }
  }
  
  /* ==========================================================================
     Utilidades
     ========================================================================== */
  .hidden {
      display: none !important;
  }
  
  /* Scrollbars personalizados */
  .chat-list::-webkit-scrollbar,
  .messages-list::-webkit-scrollbar {
      width: 6px;
  }
  
  .chat-list::-webkit-scrollbar-thumb,
  .messages-list::-webkit-scrollbar-thumb {
      background: var(--color-primary);
      border-radius: 3px;
  }
  
  .chat-list::-webkit-scrollbar-track,
  .messages-list::-webkit-scrollbar-track {
      background: transparent;
  }
  
  /* ==========================================================================
     Pantalla de Autenticación
     ========================================================================== */
  .auth-container {
      width: 100%;
      max-width: 600px;
      background: var(--color-bg-alt);
      padding: 2.2rem 1.3rem;
      box-shadow: var(--shadow-glass);
      border-radius: var(--radius);
      margin: 1.2rem;
      backdrop-filter: blur(16px);
      border: 1.5px solid var(--color-border);
  }
  
  /* Título con animación wave */
  #titulo-wave {
      text-align: center;
      margin-bottom: 1.5rem;
      font-size: 2.15rem;
      color: var(--color-primary-dark);
      font-weight: 700;
      text-shadow: 0 2px 18px rgba(30, 233, 142, 0.27);
  }
  
  #titulo-wave span {
      display: inline-block;
      animation: wave 1.5s ease-in-out infinite;
      animation-delay: calc(var(--i) * 0.1s);
  }
  
  /* Campos de autenticación */
  #emailInput,
  #usernameInput,
  #passwordInput {
      width: 100%;
      padding: 1.05rem 1.15rem;
      margin-top: 0.45rem;
      font-size: 1.08rem;
      border: 1.5px solid var(--color-border);
      border-radius: 12px;
      background: #fff;
      transition: var(--transition);
  }
  
  #loginBtn {
      width: 100%;
      padding: 1.05rem;
      background: linear-gradient(96deg, var(--color-primary) 70%, var(--color-primary-light) 100%);
      color: var(--color-text-light);
      font-weight: 700;
      font-size: 0.95rem;
      border: none;
      border-radius: 12px;
      margin-top: 1rem;
      cursor: pointer;
      transition: var(--transition);
  }
  
  /* ==========================================================================
     Selector de Idioma
     ========================================================================== */
  .language-selector {
      margin-bottom: 1.5rem;
  }
  
  .language-select,
  .language-select-main {
      width: 100%;
      padding: 0.8rem 1rem;
      border: 1.5px solid var(--color-border);
      border-radius: 10px;
      font-size: 1rem;
      background: #fff;
      color: var(--color-text);
      cursor: pointer;
  }
  
  .language-select-main {
      width: auto;
      min-width: 70px;
      padding: 4px 24px 4px 8px;
      border: 1px solid var(--color-border);
      border-radius: 8px;
      font-size: 0.85rem;
      background: #fff url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='8' height='8' viewBox='0 0 24 24'%3E%3Cpath fill='%234caf50' d='M7 10l5 5 5-5z'/%3E%3C/svg%3E") no-repeat right 8px center;
      background-size: 12px;
      cursor: pointer;
      appearance: none;
      -webkit-appearance: none;
      margin-left: 8px;
      flex-shrink: 0;
  }
  
  .language-select-main:focus {
      outline: none;
      border-color: var(--color-primary);
      box-shadow: 0 0 0 2px rgba(76, 175, 80, 0.1);
  }
  
  /* Ajuste responsive */
  @media (max-width: 380px) {
      .language-select-main {
          min-width: 60px;
          padding: 4px 20px 4px 4px;
          font-size: 0.8rem;
      }
  }
  
  /* ==========================================================================
     Selector de Temas
     ========================================================================== */
  
  .theme-select-main {
      width: auto;
      min-width: 70px;
      padding: 4px 24px 4px 8px;
      border: 1px solid var(--color-border);
      border-radius: 8px;
      font-size: 0.85rem;
      background: #fff url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='8' height='8' viewBox='0 0 24 24'%3E%3Cpath fill='%234caf50' d='M7 10l5 5 5-5z'/%3E%3C/svg%3E") no-repeat right 8px center;
      background-size: 12px;
      cursor: pointer;
      appearance: none;
      -webkit-appearance: none;
      margin-left: 8px;
      flex-shrink: 0;
  }
  
  .theme-select-main:focus {
      outline: none;
      border-color: var(--color-primary);
      box-shadow: 0 0 0 2px rgba(76, 175, 80, 0.1);
  }
  
  /* Responsive */
  @media (max-width: 380px) {
      .theme-select-main {
          min-width: 60px;
          padding: 4px 20px 4px 4px;
          font-size: 0.8rem;
      }
  }
  
  
  
  
  
  
  /* ==========================================================================
     Componentes de Chat
     ========================================================================== */
  /* Búsqueda */
  .search-container {
      position: sticky;
      top: var(--header-height);
      padding: 10px;
      background: #fff;
      z-index: 99;
      border-bottom: 1px solid var(--color-border);
  }
  
  #searchContacts {
      width: 100%;
      height: 40px;
      padding: 8px 12px;
      border: 1px solid var(--color-border);
      border-radius: 20px;
      font-size: 14px;
      background: var(--color-bg-alt);
  }
  
  /* Indicador de Escritura */
  #typingIndicator {
      padding: 5px 10px;
      margin: 5px;
      font-style: italic;
      color: var(--color-system);
      text-align: center;
      animation: fadeIn 0.3s ease;
  }
  
  /* Mensajes del Sistema */
  .system-message {
      text-align: center;
      margin: 10px 0;
      padding: 8px 12px;
      background: var(--color-system-bg);
      border-radius: 15px;
      font-style: italic;
      color: var(--color-system);
      font-size: 0.9em;
  }
  
  /* Botón de Micrófono */
  #micButton {
      background: transparent;
      border: 1px solid var(--color-primary);
      color: var(--color-primary);
  }
  
  #micButton.recording {
      background: var(--color-danger);
      color: white;
      border: none;
      animation: pulse 1.5s infinite;
  }
  
  /* ==========================================================================
     Modal de Grupo
     ========================================================================== */
  .modal {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.5);
      display: flex;
      justify-content: center;
      align-items: center;
      z-index: 1000;
      backdrop-filter: blur(4px);
  }
  
  .modal-content {
      background: white;
      border-radius: 16px;
      padding: 24px;
      width: 90%;
      max-width: 500px;
      max-height: 90vh;
      overflow-y: auto;
      box-shadow: var(--shadow);
  }
  
  .selected-users {
      background: var(--color-bg);
      border-radius: 8px;
      padding: 12px;
      margin: 12px 0;
  }
  
  .selected-user-item {
      background: var(--color-user-left);
      color: var(--color-primary-dark);
      padding: 6px 12px;
      border-radius: 16px;
      margin: 4px;
      display: inline-flex;
      align-items: center;
      gap: 8px;
  }
  
  .remove-user {
      cursor: pointer;
      padding: 2px 6px;
      border-radius: 50%;
      background: rgba(0, 0, 0, 0.1);
  }
  
  /* ==========================================================================
     Animaciones Adicionales
     ========================================================================== */
  @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
  }
  
  @keyframes wave {
      0%, 60%, 100% { transform: translateY(0); }
      30% { transform: translateY(-10px); }
  }
  
  @keyframes pulse {
      0% { transform: scale(1); }
      50% { transform: scale(1.1); }
      100% { transform: scale(1); }
  }
  
  @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
  }
  
  /* ==========================================================================
     Ajustes Responsive Adicionales
     ========================================================================== */
  @media (max-width: 768px) {
      .back-button {
          display: flex;
          align-items: center;
          justify-content: center;
      }
  
      .modal-content {
          width: 95%;
          padding: 20px;
          margin: 10px;
      }
  
      #titulo-wave {
          font-size: 1.8rem;
      }
  
      .auth-container {
          padding: 1.5rem 1rem;
      }
  
      .selected-users {
          max-height: 150px;
          overflow-y: auto;
      }
  }
  
  /* ==========================================================================
     Ajustes iOS Adicionales
     ========================================================================== */
  @supports (-webkit-touch-callout: none) {
      .modal-content {
          max-height: calc(100vh - 100px);
      }
  
      .search-container {
          position: sticky;
          top: calc(var(--header-height) + var(--safe-area-top));
      }
  
      #authScreen {
          padding-top: var(--safe-area-top);
          padding-bottom: var(--safe-area-bottom);
      }
  }
  
  /* ==========================================================================
     Estados y Utilidades Adicionales
     ========================================================================== */
  .chat-item.group-chat {
      background: var(--color-bg-alt);
      border-left: 3px solid var(--color-primary-light);
  }
  
  .chat-updated {
      animation: highlightChat 2s ease;
  }
  
  @keyframes highlightChat {
      0% { background-color: var(--color-user-left); }
      100% { background-color: var(--color-bg); }
  }
  
  /* Ajustes de accesibilidad */
  button:focus-visible,
  input:focus-visible,
  select:focus-visible {
      outline: 2px solid var(--color-primary);
      outline-offset: 2px;
  }
  
  /* Estados de error */
  .error-message {
      color: var(--color-danger);
      font-size: 0.9rem;
      margin-top: 0.5rem;
      text-align: center;
  }
  
  /* Estados de carga */
  .loading {
      opacity: 0.7;
      pointer-events: none;
  }
  
  /* Ajustes de scroll para iOS */
  .messages-list,
  .chat-list,
  .modal-content {
      -webkit-overflow-scrolling: touch;
      scroll-behavior: smooth;
  }
  
  /* ==========================================================================
     Header Actions y Botones
     ========================================================================== */
  .header-actions {
      display: flex;
      align-items: center;
      gap: 8px;
      margin-left: auto;
  }
  
  #createGroup {
      background: #2e7d32;
  }

  #createGroup:hover {
      background: #1b5e20;
  }


  
  #logoutBtn {
      background: var(--color-danger);
  }
  
  #logoutBtn:hover {
      background: #dc2626;
  }
  
  /* ==========================================================================
     Chat Details y Elementos de Usuario
     ========================================================================== */
  .chat-details {
      flex: 1;
      min-width: 0;
      overflow: hidden;
  }
  
  .chat-name {
      font-weight: 600;
      font-size: 0.95rem;
      color: var(--color-primary-dark);
      margin-bottom: 2px;
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
  }
  
  .last-message {
      color: #667781;
      font-size: 0.85rem;
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
  }
  
  .last-message-time {
      font-size: 0.75rem;
      color: #667781;
      white-space: nowrap;
      align-self: flex-start;
      margin-top: 2px;
  }
  
  /* ==========================================================================
     Búsqueda de Usuarios y Resultados
     ========================================================================== */
  .search-instruction {
      padding: 1rem;
      text-align: center;
      color: #666;
      font-size: 14px;
      background: #f8f9fa;
      border-bottom: 1px solid #f0f2f5;
  }
  
  .chat-item.search-result {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 12px 16px;
      gap: 12px;
      cursor: default;
      transition: background 0.2s;
  }
  
  .chat-item.search-result:hover {
      background: var(--color-user-left);
  }
  
  .chat-item.search-result .user-info {
      flex: 1;
      min-width: 0;
      padding-right: 8px;
  }
  
  .chat-item.search-result .user-name {
      font-weight: 600;
      color: var(--color-text);
      margin-bottom: 2px;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
  }
  
  .chat-item.search-result .user-email {
      font-size: 0.85rem;
      color: #667781;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
  }
  
  .start-chat-btn {
      display: flex;
      align-items: center;
      gap: 8px;
      padding: 8px 16px;
      background: var(--color-primary);
      color: white;
      border: none;
      border-radius: 20px;
      font-size: 0.9rem;
      cursor: pointer;
      transition: all 0.2s ease;
      white-space: nowrap;
      flex-shrink: 0;
  }
  
  .start-chat-btn:hover {
      background: var(--color-primary-dark);
      transform: translateY(-1px);
  }
  
  .start-chat-btn i {
      font-size: 1rem;
  }
  
  /* Ajustes móviles para resultados de búsqueda */
  @media (max-width: 768px) {
      .chat-item.search-result {
          padding: 10px 12px;
      }
  
      .start-chat-btn {
          padding: 6px 12px;
          font-size: 0.8rem;
      }
  
      .start-chat-btn i {
          font-size: 0.9rem;
      }
      
      /* En móvil, mostrar solo el icono si el espacio es muy reducido */
      @media (max-width: 360px) {
          .start-chat-btn span {
              display: none;
          }
          
          .start-chat-btn {
              padding: 8px;
          }
      }
  }
  
  /* ==========================================================================
     Grupo y Modal de Creación
     ========================================================================== */
  .group-form {
      display: flex;
      flex-direction: column;
      gap: 16px;
  }
  
  .group-form input {
      width: 100%;
      padding: 12px;
      border: 1px solid var(--color-border);
      border-radius: 8px;
      font-size: 1rem;
  }
  
  .group-button {
      display: flex;
      align-items: center;
      gap: 10px;
      color: var(--color-primary-dark);
      font-weight: 500;
  }
  
  .group-button i {
      font-size: 1.2rem;
  }
  
  .modal-buttons {
      display: flex;
      gap: 12px;
      margin-top: 24px;
  }
  
  #createGroupBtn,
  #cancelGroupBtn {
      flex: 1;
      padding: 12px;
      border-radius: 8px;
      font-weight: 500;
      transition: var(--transition);
  }
  
  #createGroupBtn {
      background: var(--color-primary);
      color: white;
  }
  
  #createGroupBtn:disabled {
      background: #c7d2fe;
      cursor: not-allowed;
  }
  
  #cancelGroupBtn {
      background: #f3f4f6;
      color: #4b5563;
      border: 1px solid #e5e7eb;
  }
  
  /* ==========================================================================
     Mensajes y Estados de Chat
     ========================================================================== */
  .message-sender {
      font-size: 0.75em;
      color: var(--color-primary-dark);
      margin-bottom: 2px;
      font-weight: 500;
  }
  
  .message-sender.sent {
      text-align: right;
  }
  
  .message-content {
      display: flex;
      align-items: flex-end;
      gap: 3px;
      position: relative;
  }
  
  .message-flag {
      font-size: 0.7em;
      margin: 0 3px;
  }
  
  .message-time {
      font-size: 0.65em;
      color: rgba(134, 150, 160, 0.9);
      margin: 0 3px 1px 3px;
      white-space: nowrap;
  }
  
  /* ==========================================================================
     Audio Messages
     ========================================================================== */
  .audio-message {
      display: flex;
      align-items: center;
      gap: 8px;
      padding: 8px;
      background: var(--color-bg-alt);
      border-radius: 8px;
  }
  
  .audio-message .play-button {
      width: 36px;
      height: 36px;
      border-radius: 50%;
      border: none;
      background: var(--color-primary);
      color: white;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
  }
  
  .audio-message .waveform {
      flex: 1;
      height: 40px;
      background: var(--color-primary-light);
      opacity: 0.3;
      border-radius: 4px;
  }
  
  .audio-message .transcription {
      font-style: italic;
      margin-top: 4px;
      font-size: 0.9em;
      color: var(--color-text);
  }
  
  /* ==========================================================================
     Ajustes de Teclado para iOS
     ========================================================================== */
  .keyboard-open body {
      height: calc(100% - var(--keyboard-height, 0px));
  }
  
  .keyboard-open #mainScreen {
      height: calc(100% - var(--keyboard-height, 0px));
  }
  
  .keyboard-open .messages-list {
      height: calc(100vh - var(--header-height) - var(--message-input-height) - var(--keyboard-height, 0px));
  }
  
  .keyboard-open .message-input {
      bottom: var(--keyboard-height, 0px);
  }
  
  /* ==========================================================================
     Ajustes de Pantalla Completa
     ========================================================================== */
  .screen {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      display: none;
      opacity: 0;
      visibility: hidden;
      transition: opacity 0.3s ease;
  }
  
  .screen.active {
      display: flex;
      opacity: 1;
      visibility: visible;
  }
  
  /* ==========================================================================
     Z-Index Hierarchy
     ========================================================================== */
  .loading-screen { z-index: 1000; }
  .modal { z-index: 900; }
  .chat-header { z-index: 800; }
  .message-input { z-index: 700; }
  .search-container { z-index: 600; }
  .sidebar { z-index: 500; }
  
  /* ==========================================================================
     Transiciones y Efectos
     ========================================================================== */
  .fade-enter {
      opacity: 0;
      transform: translateY(20px);
  }
  
  .fade-enter-active {
      opacity: 1;
      transform: translateY(0);
      transition: opacity 0.3s, transform 0.3s;
  }
  
  /* ==========================================================================
     Ajustes de Accesibilidad
     ========================================================================== */
  @media (prefers-reduced-motion: reduce) {
      * {
          animation-duration: 0.01ms !important;
          animation-iteration-count: 1 !important;
          transition-duration: 0.01ms !important;
          scroll-behavior: auto !important;
      }
  }
  
  .screen-reader-only {
      position: absolute;
      width: 1px;
      height: 1px;
      padding: 0;
      margin: -1px;
      overflow: hidden;
      clip: rect(0, 0, 0, 0);
      border: 0;
  }
  
  /* ==========================================================================
     Headers y Safe Areas
     ========================================================================== */
  .user-header,
  .chat-header {
      height: var(--header-height);
      padding: 12px 15px;
      background-color: #fff;
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 10px;
      position: sticky;
      top: 0;
      z-index: 10;
      border-bottom: 1px solid var(--color-border);
  }
  
  .chat-header {
      background-color: var(--color-bg-alt);
  }
  
  /* ==========================================================================
     Ajustes iOS
     ========================================================================== */
  @supports (-webkit-touch-callout: none) {
      /* Headers en iOS */
      .user-header,
      .chat-header {
          height: calc(var(--header-height) + var(--safe-area-top));
          padding-top: calc(var(--safe-area-top) + 8px);
          background-color: rgba(255, 255, 255, 0.95);
          backdrop-filter: blur(10px);
          -webkit-backdrop-filter: blur(10px);
      }
  
      .chat-header {
          background-color: rgba(246, 250, 247, 0.95);
      }
  
      /* Ajustes específicos para diferentes modelos de iPhone */
      @media screen and 
          /* iPhone X, XS, 11 Pro */
          (device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3),
          /* iPhone XR, 11 */
          (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 2),
          /* iPhone XS Max, 11 Pro Max */
          (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 3),
          /* iPhone 12 y posteriores */
          (device-width: 390px) and (device-height: 844px) and (-webkit-device-pixel-ratio: 3),
          (device-width: 428px) and (device-height: 926px) and (-webkit-device-pixel-ratio: 3),
          (device-width: 393px) and (device-height: 852px) and (-webkit-device-pixel-ratio: 3),
          (device-width: 430px) and (device-height: 932px) and (-webkit-device-pixel-ratio: 3) {
          
          :root {
              --safe-area-top: env(safe-area-inset-top, 47px);
              --safe-area-bottom: env(safe-area-inset-bottom, 34px);
          }
  
          .user-header,
          .chat-header {
              padding-top: calc(env(safe-area-inset-top) + 8px);
              height: calc(var(--header-height) + env(safe-area-inset-top));
              border-bottom: 0.5px solid rgba(0, 0, 0, 0.2);
          }
  
          /* Ajustar contenido debajo del header */
          .chat-list {
              height: calc(100% - (var(--header-height) + env(safe-area-inset-top)));
              padding-bottom: env(safe-area-inset-bottom);
          }
  
          .messages-list {
              height: calc(100% - (var(--header-height) + env(safe-area-inset-top)) - var(--message-input-height));
              padding-bottom: calc(env(safe-area-inset-bottom) + 10px);
          }
      }
  }
  
  /* ==========================================================================
     Scrollbars
     ========================================================================== */
  /* Scrollbar para Firefox */
  .chat-list,
  .messages-list {
      scrollbar-width: thin;
      scrollbar-color: var(--color-primary) transparent;
  }
  
  /* Scrollbar para Chrome/Safari/Edge */
  .chat-list::-webkit-scrollbar,
  .messages-list::-webkit-scrollbar {
      width: 6px;
      height: 6px;
  }
  
  .chat-list::-webkit-scrollbar-track,
  .messages-list::-webkit-scrollbar-track {
      background: transparent;
  }
  
  .chat-list::-webkit-scrollbar-thumb,
  .messages-list::-webkit-scrollbar-thumb {
      background: var(--color-primary);
      border-radius: 3px;
  }
  
  /* Scrollbar para iOS */
  @supports (-webkit-touch-callout: none) {
      .chat-list,
      .messages-list {
          /* Habilitar scrollbar en iOS */
          -webkit-overflow-scrolling: touch;
          overflow-y: auto;
          
          /* Estilizar scrollbar */
          &::-webkit-scrollbar {
              -webkit-appearance: none;
              width: 6px;
          }
          
          &::-webkit-scrollbar-track {
              background: transparent;
              border-radius: 3px;
          }
          
          &::-webkit-scrollbar-thumb {
              background: var(--color-primary);
              border-radius: 3px;
          }
          
          /* Asegurar que el scroll sea suave */
          scroll-behavior: smooth;
      }
  }
  
  /* ==========================================================================
     Diálogo de confirmación
     ========================================================================== */
  .delete-confirm-dialog {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background: white;
      padding: 16px;
      border-radius: 8px;
      box-shadow: 0 2px 12px rgba(0, 0, 0, 0.1);
      z-index: 1000;
      max-width: 90%;
      width: 280px;
      text-align: center;
  }
  
  .delete-confirm-dialog p {
      color: var(--color-text);
      font-size: 0.95rem;
      margin-bottom: 16px;
  }
  
  .delete-confirm-dialog .dialog-buttons {
      display: flex;
      gap: 8px;
      justify-content: flex-end;
  }
  
  .delete-confirm-dialog button {
      padding: 6px 12px;
      border-radius: 6px;
      border: none;
      cursor: pointer;
      font-size: 0.9rem;
      font-weight: 500;
      transition: all 0.2s ease;
  }
  
  .delete-confirm-dialog .confirm-delete {
      background: var(--color-danger);
      color: white;
  }
  
  .delete-confirm-dialog .confirm-delete:hover {
      background: #c62828;
  }
  
  .delete-confirm-dialog .cancel-delete {
      background: #f5f5f5;
      color: var(--color-text);
  }
  
  .delete-confirm-dialog .cancel-delete:hover {
      background: #eeeeee;
  }
  
  .dialog-backdrop {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.4);
      backdrop-filter: blur(2px);
      z-index: 999;
  }
  
  /* ==========================================================================
     Ajustes móviles para el botón de borrar
     ========================================================================== */
  @media (max-width: 768px) {
      .delete-chat-btn {
          opacity: 0.6;
          padding: 8px;
      }
      
      .delete-chat-btn i {
          font-size: 1rem;
      }
  }
  
  
  .theme-selector {
    margin-top: 10px;
    display: flex;
    flex-direction: column;
    gap: 5px;
  }
  
  .theme-select {
    padding: 10px 12px;
    font-size: 1rem;
    border: 1px solid var(--color-border);
    border-radius: 8px;
    background-color: var(--color-bg-alt);
    color: #333;
    font-family: 'Poppins', sans-serif;
    transition: border-color 0.3s ease;
  }
  
  .theme-select:focus {
    outline: none;
    border-color: var(--color-primary);
  }
  
  /* ==========================================================================
     Barra de Navegación
     ========================================================================== */
  .bottom-nav {
      position: fixed;
      bottom: 0;
      left: 0;
      width: 350px;
      height: 55px;
      background: var(--color-bg-alt);
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
      display: flex;
      justify-content: space-around;
      align-items: center;
      border-top: 1px solid var(--color-border);
      z-index: 600;
      padding-bottom: env(safe-area-inset-bottom, 0px);
  }
  
  .nav-button {
      background: transparent;
      border: none;
      color: var(--color-primary);
      padding: 10px;
      cursor: pointer;
      transition: var(--transition);
      display: flex;
      align-items: center;
      justify-content: center;
  }
  
  .nav-button i {
      font-size: 1.5rem;
  }
  
  .nav-button:hover {
      color: var(--color-primary-dark);
  }
  
  .nav-button.active {
      color: var(--color-primary-dark);
  }
  
  /* Ajustes específicos para iOS */
  @supports (-webkit-touch-callout: none) {
      .bottom-nav {
          height: calc(55px + env(safe-area-inset-bottom));
          padding-bottom: max(10px, var(--safe-area-bottom));
      }

      .chat-list,
      .groups-list {
          padding-bottom: calc(180px + env(safe-area-inset-bottom));
      }
  }
  
  /* Ajustes para móvil */
  @media (max-width: 768px) {
      .bottom-nav {
          width: 100%;
      }
  }
  
  /* ==========================================================================
     Página de Ajustes
     ========================================================================== */
  .settings-page {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: var(--color-bg);
      z-index: 700;
      display: flex;
      flex-direction: column;
  }
  
  .settings-page.hidden {
      display: none;
  }
  
  .settings-header {
      height: var(--header-height);
      padding: 12px 15px;
      background: var(--color-bg-alt);
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
      display: flex;
      align-items: center;
      gap: 15px;
      border-bottom: 1px solid var(--color-border);
  }
  
  .settings-header h2 {
      font-size: 1.2rem;
      color: var(--color-primary-dark);
      font-weight: 600;
  }
  
  .settings-content {
      flex: 1;
      overflow-y: auto;
      padding: 20px 15px;
      padding-bottom: calc(70px + env(safe-area-inset-bottom, 0px));
  }
  
  .settings-section {
      margin-bottom: 25px;
      background: var(--color-bg-alt);
      border-radius: var(--radius);
      overflow: hidden;
      border: 1px solid var(--color-border);
  }
  
  .settings-section h3 {
      font-size: 0.9rem;
      color: var(--color-primary-dark);
      padding: 10px 15px;
      background: var(--color-user-left);
      font-weight: 600;
  }
  
  .settings-item {
      display: flex;
      align-items: center;
      padding: 15px;
      gap: 15px;
      border-bottom: 1px solid var(--color-border);
  }
  
  .settings-item:last-child {
      border-bottom: none;
  }
  
  .settings-item i {
      font-size: 1.2rem;
      color: var(--color-primary);
      width: 24px;
      text-align: center;
  }
  
  .settings-item-content {
      flex: 1;
      display: flex;
      flex-direction: column;
      gap: 5px;
  }
  
  .settings-item-content label {
      font-size: 0.85rem;
      color: var(--color-text);
      opacity: 0.8;
  }
  
  .settings-select,
  #settingsUsername {
      width: 100%;
      padding: 8px;
      border: 1px solid var(--color-border);
      border-radius: 8px;
      font-size: 0.95rem;
      background: var(--color-bg);
      color: var(--color-text);
  }
  
  .settings-select:focus {
      border-color: var(--color-primary);
      outline: none;
  }
  
  #settingsUsername {
      background: var(--color-user-left);
      border: none;
  }
  
  .app-version {
      font-size: 0.9rem;
      color: var(--color-text);
      opacity: 0.7;
  }
  
  .app-developer {
      display: block;
      font-size: 0.7rem;
      color: var(--color-text);
      opacity: 0.6;
      margin-top: 4px;
      font-style: italic;
  }
  
  .settings-logout-btn {
      width: 100%;
      padding: 15px;
      background: none;
      border: none;
      color: var(--color-danger);
      font-size: 1rem;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 10px;
      cursor: pointer;
      transition: var(--transition);
  }
  
  .settings-logout-btn:hover {
      background: var(--color-user-right);
  }
  
  /* Ajustes iOS */
  @supports (-webkit-touch-callout: none) {
      .settings-header {
          padding-top: calc(var(--safe-area-top) + 12px);
          height: calc(var(--header-height) + var(--safe-area-top));
      }
  }
  
  .readonly-input {
      background-color: #f3f4f6;
      border: 1px solid #e5e7eb;
      color: #374151;
      cursor: default;
      padding: 8px 12px;
      border-radius: 6px;
      width: 100%;
      font-size: 14px;
  }
  
  .readonly-input:focus {
      outline: none;
      border-color: #e5e7eb;
      box-shadow: none;
  }
  
  .user-header h2,
  .settings-header h2 {
      font-size: 1.2rem;
      color: var(--color-primary-dark);
      font-weight: 600;
  }

.chat-item.unread {
  background-color: var(--color-unread);
  font-weight: bold;
  border-left: 4px solid var(--color-primary-dark);
}


/* ==========================================================================
     Página de Grupos
     ========================================================================== */
.groups-page {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: var(--color-bg);
    z-index: 700;
    display: flex;
    flex-direction: column;
}

.groups-page.hidden {
    display: none;
}

.groups-header {
    height: var(--header-height);
    padding: 12px 15px;
    background: var(--color-bg-alt);
    backdrop-filter: blur(10px);
    -webkit-backdrop-filter: blur(10px);
    display: flex;
    align-items: center;
    gap: 15px;
    border-bottom: 1px solid var(--color-border);
}

.groups-header h2 {
    font-size: 1.2rem;
    color: var(--color-primary-dark);
    font-weight: 600;
}

/* Ajustes iOS para la página de grupos */
@supports (-webkit-touch-callout: none) {
    .groups-header {
        padding-top: calc(var(--safe-area-top) + 12px);
        height: calc(var(--header-height) + var(--safe-area-top));
    }
}

/* Ocultar el botón de nuevo chat en la página de grupos */
.groups-page #newGroupChat {
    display: none;
}

/* Ocultar el botón de crear grupo en la página de chats individuales */
#createGroup {
    display: none;
}


.spinner {
  width: 40px;
  height: 40px;
  border: 4px solid var(--color-primary-dark);
  border-top-color: #555;
  border-radius: 50%;
  animation: spin 0.8s linear infinite;
}

@keyframes spin {
  to {
    transform: rotate(360deg);
  }
}

.in-app-toast {
  position: fixed;
  bottom: 20px;
  left: 50%;
  transform: translateX(-50%) translateY(20px);
  background: rgba(0, 0, 0, 0.8);
  color: #fff;
  padding: 10px 20px;
  border-radius: 4px;
  opacity: 0;
  transition: opacity 0.3s ease, transform 0.3s ease;
  z-index: 1000;
  pointer-events: none;
}

.in-app-toast.show {
  opacity: 1;
  transform: translateX(-50%) translateY(0);
}
